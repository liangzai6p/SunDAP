<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunyard.ars.system.dao.busm.UserDao">
    <resultMap id="BaseResultMap" type="com.sunyard.ars.system.bean.busm.UserBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="USER_NO" jdbcType="VARCHAR" property="userNo"/>
        <id column="BANK_NO" jdbcType="VARCHAR" property="bankNo"/>
        <id column="SYSTEM_NO" jdbcType="VARCHAR" property="systemNo"/>
        <id column="PROJECT_NO" jdbcType="VARCHAR" property="projectNo"/>
        <result column="PASSWORD" jdbcType="VARCHAR" property="password"/>
        <result column="ORGAN_NO" jdbcType="VARCHAR" property="organNo"/>
        <result column="USER_NAME" jdbcType="VARCHAR" property="userName"/>
        <result column="USER_ENABLE" jdbcType="CHAR" property="userEnable"/>
        <result column="TELLERLVL" jdbcType="VARCHAR" property="tellerlvl"/>
        <result column="LOGIN_MODE" jdbcType="CHAR" property="loginMode"/>
        <result column="LOGIN_STATE" jdbcType="VARCHAR" property="loginState"/>
        <result column="USER_STATUS" jdbcType="VARCHAR" property="userStatus"/>
        <result column="LAST_LOGIN_TIME" jdbcType="VARCHAR" property="lastLoginTime"/>
        <result column="LAST_LOGOUT_TIME" jdbcType="VARCHAR" property="lastLogoutTime"/>
        <result column="LAST_MODI_DATE" jdbcType="VARCHAR" property="lastModiDate"/>
        <result column="UNDERSIGNED" jdbcType="VARCHAR" property="undersigned"/>
        <result column="TERMINAL_IP" jdbcType="VARCHAR" property="terminalIp"/>
        <result column="TERMINAL_MAC" jdbcType="VARCHAR" property="terminalMac"/>
        <result column="LOGIN_PC_SERVER" jdbcType="VARCHAR" property="loginPcServer"/>
        <result column="LOGIN_MOBILE_SERVER" jdbcType="VARCHAR" property="loginMobileServer"/>
        <result column="MOBILE" jdbcType="VARCHAR" property="mobile"/>
        <result column="SINGLE_LOGIN" jdbcType="VARCHAR" property="singleLogin"/>
    </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    USER_NO, BANK_NO, SYSTEM_NO, PROJECT_NO, PASSWORD, ORGAN_NO, USER_NAME, USER_ENABLE, 
    TELLERLVL, LOGIN_MODE, LOGIN_STATE, USER_STATUS, LAST_LOGIN_TIME, LAST_LOGOUT_TIME, 
    LAST_MODI_DATE, UNDERSIGNED, TERMINAL_IP, TERMINAL_MAC, LOGIN_PC_SERVER, LOGIN_MOBILE_SERVER,MOBILE,SINGLE_LOGIN
  </sql>
  <select id="selectByPrimaryKey" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from SM_USERS_TB
    where USER_NO = #{userNo,jdbcType=VARCHAR}
      and BANK_NO = #{bankNo,jdbcType=VARCHAR}
      and SYSTEM_NO = #{systemNo,jdbcType=VARCHAR}
      and PROJECT_NO = #{projectNo,jdbcType=VARCHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="map">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from SM_USERS_TB
    where USER_NO = #{userNo,jdbcType=VARCHAR}
      and BANK_NO = #{bankNo,jdbcType=VARCHAR}
      and SYSTEM_NO = #{systemNo,jdbcType=VARCHAR}
      and PROJECT_NO = #{projectNo,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="com.sunyard.ars.system.bean.busm.UserBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into SM_USERS_TB (USER_NO, BANK_NO, SYSTEM_NO, 
      PROJECT_NO, PASSWORD, ORGAN_NO, 
      USER_NAME, USER_ENABLE, TELLERLVL, 
      LOGIN_MODE, LOGIN_STATE, USER_STATUS, 
      LAST_LOGIN_TIME, LAST_LOGOUT_TIME, LAST_MODI_DATE, 
      UNDERSIGNED, TERMINAL_IP, TERMINAL_MAC, 
      LOGIN_PC_SERVER, LOGIN_MOBILE_SERVER,SINGLE_LOGIN
      )
    values (#{userNo,jdbcType=VARCHAR}, #{bankNo,jdbcType=VARCHAR}, #{systemNo,jdbcType=VARCHAR}, 
      #{projectNo,jdbcType=VARCHAR}, #{password,jdbcType=VARCHAR}, #{organNo,jdbcType=VARCHAR}, 
      #{userName,jdbcType=VARCHAR}, #{userEnable,jdbcType=CHAR}, #{tellerlvl,jdbcType=VARCHAR}, 
      #{loginMode,jdbcType=CHAR}, #{loginState,jdbcType=VARCHAR}, #{userStatus,jdbcType=VARCHAR}, 
      #{lastLoginTime,jdbcType=VARCHAR}, #{lastLogoutTime,jdbcType=VARCHAR}, #{lastModiDate,jdbcType=VARCHAR}, 
      #{undersigned,jdbcType=VARCHAR}, #{terminalIp,jdbcType=VARCHAR}, #{terminalMac,jdbcType=VARCHAR}, 
      #{loginPcServer,jdbcType=VARCHAR}, #{loginMobileServer,jdbcType=VARCHAR}#{singleLogin,jdbcType=VARCHAR}
      )
  </insert>
    <insert id="insertSelective" parameterType="com.sunyard.ars.system.bean.busm.UserBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into SM_USERS_TB
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="userNo != null">
                USER_NO,
            </if>
            <if test="bankNo != null">
                BANK_NO,
            </if>
            <if test="systemNo != null">
                SYSTEM_NO,
            </if>
            <if test="projectNo != null">
                PROJECT_NO,
            </if>
            <if test="password != null">
                PASSWORD,
            </if>
            <if test="organNo != null">
                ORGAN_NO,
            </if>
            <if test="userName != null">
                USER_NAME,
            </if>
            <if test="userEnable != null">
                USER_ENABLE,
            </if>
            <if test="tellerlvl != null">
                TELLERLVL,
            </if>
            <if test="loginMode != null">
                LOGIN_MODE,
            </if>
            <if test="loginState != null">
                LOGIN_STATE,
            </if>
            <if test="userStatus != null">
                USER_STATUS,
            </if>
            <if test="lastLoginTime != null">
                LAST_LOGIN_TIME,
            </if>
            <if test="lastLogoutTime != null">
                LAST_LOGOUT_TIME,
            </if>
            <if test="lastModiDate != null">
                LAST_MODI_DATE,
            </if>
            <if test="undersigned != null">
                UNDERSIGNED,
            </if>
            <if test="terminalIp != null">
                TERMINAL_IP,
            </if>
            <if test="terminalMac != null">
                TERMINAL_MAC,
            </if>
            <if test="loginPcServer != null">
                LOGIN_PC_SERVER,
            </if>
            <if test="loginMobileServer != null">
                LOGIN_MOBILE_SERVER,
            </if>
            <if test="mobile != null">
                MOBILE,
            </if>
            <if test="singleLogin != null">
                SINGLE_LOGIN
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="userNo != null">
                #{userNo,jdbcType=VARCHAR},
            </if>
            <if test="bankNo != null">
                #{bankNo,jdbcType=VARCHAR},
            </if>
            <if test="systemNo != null">
                #{systemNo,jdbcType=VARCHAR},
            </if>
            <if test="projectNo != null">
                #{projectNo,jdbcType=VARCHAR},
            </if>
            <if test="password != null">
                #{password,jdbcType=VARCHAR},
            </if>
            <if test="organNo != null">
                #{organNo,jdbcType=VARCHAR},
            </if>
            <if test="userName != null">
                #{userName,jdbcType=VARCHAR},
            </if>
            <if test="userEnable != null">
                #{userEnable,jdbcType=CHAR},
            </if>
            <if test="tellerlvl != null">
                #{tellerlvl,jdbcType=VARCHAR},
            </if>
            <if test="loginMode != null">
                #{loginMode,jdbcType=CHAR},
            </if>
            <if test="loginState != null">
                #{loginState,jdbcType=VARCHAR},
            </if>
            <if test="userStatus != null">
                #{userStatus,jdbcType=VARCHAR},
            </if>
            <if test="lastLoginTime != null">
                #{lastLoginTime,jdbcType=VARCHAR},
            </if>
            <if test="lastLogoutTime != null">
                #{lastLogoutTime,jdbcType=VARCHAR},
            </if>
            <if test="lastModiDate != null">
                #{lastModiDate,jdbcType=VARCHAR},
            </if>
            <if test="undersigned != null">
                #{undersigned,jdbcType=VARCHAR},
            </if>
            <if test="terminalIp != null">
                #{terminalIp,jdbcType=VARCHAR},
            </if>
            <if test="terminalMac != null">
                #{terminalMac,jdbcType=VARCHAR},
            </if>
            <if test="loginPcServer != null">
                #{loginPcServer,jdbcType=VARCHAR},
            </if>
            <if test="loginMobileServer != null">
                #{loginMobileServer,jdbcType=VARCHAR},
            </if>
            <if test="mobile != null">
                #{mobile,jdbcType=VARCHAR},
            </if>
            <if test="singleLogin != null">
                #{singleLogin,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.sunyard.ars.system.bean.busm.UserBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update SM_USERS_TB
    <set>
      <if test="password != null">
        PASSWORD = #{password,jdbcType=VARCHAR},
      </if>
      <if test="organNo != null">
        ORGAN_NO = #{organNo,jdbcType=VARCHAR},
      </if>
      <if test="userName != null">
        USER_NAME = #{userName,jdbcType=VARCHAR},
      </if>
      <if test="userEnable != null">
        USER_ENABLE = #{userEnable,jdbcType=CHAR},
      </if>
      <if test="tellerlvl != null">
        TELLERLVL = #{tellerlvl,jdbcType=VARCHAR},
      </if>
      <if test="loginMode != null">
        LOGIN_MODE = #{loginMode,jdbcType=CHAR},
      </if>
      <if test="loginState != null">
        LOGIN_STATE = #{loginState,jdbcType=VARCHAR},
      </if>
      <if test="userStatus != null">
        USER_STATUS = #{userStatus,jdbcType=VARCHAR},
      </if>
      <if test="lastLoginTime != null">
        LAST_LOGIN_TIME = #{lastLoginTime,jdbcType=VARCHAR},
      </if>
      <if test="lastLogoutTime != null">
        LAST_LOGOUT_TIME = #{lastLogoutTime,jdbcType=VARCHAR},
      </if>
      <if test="lastModiDate != null">
        LAST_MODI_DATE = #{lastModiDate,jdbcType=VARCHAR},
      </if>
      <if test="undersigned != null">
        UNDERSIGNED = #{undersigned,jdbcType=VARCHAR},
      </if>
      <if test="terminalIp != null">
        TERMINAL_IP = #{terminalIp,jdbcType=VARCHAR},
      </if>
      <if test="terminalMac != null">
        TERMINAL_MAC = #{terminalMac,jdbcType=VARCHAR},
      </if>
      <if test="loginPcServer != null">
        LOGIN_PC_SERVER = #{loginPcServer,jdbcType=VARCHAR},
      </if>
      <if test="loginMobileServer != null">
        LOGIN_MOBILE_SERVER = #{loginMobileServer,jdbcType=VARCHAR},
      </if>
       <if test="mobile!= null">
        	MOBILE = #{mobile,jdbcType=VARCHAR},
      </if>
        <if test="singleLogin!= null">
            SINGLE_LOGIN = #{singleLogin,jdbcType=VARCHAR},
        </if>
    </set>
    where USER_NO = #{userNo,jdbcType=VARCHAR}
      and BANK_NO = #{bankNo,jdbcType=VARCHAR}
      and SYSTEM_NO = #{systemNo,jdbcType=VARCHAR}
      and PROJECT_NO = #{projectNo,jdbcType=VARCHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.sunyard.ars.system.bean.busm.UserBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update SM_USERS_TB
    set PASSWORD = #{password,jdbcType=VARCHAR},
      ORGAN_NO = #{organNo,jdbcType=VARCHAR},
      USER_NAME = #{userName,jdbcType=VARCHAR},
      USER_ENABLE = #{userEnable,jdbcType=CHAR},
      TELLERLVL = #{tellerlvl,jdbcType=VARCHAR},
      LOGIN_MODE = #{loginMode,jdbcType=CHAR},
      LOGIN_STATE = #{loginState,jdbcType=VARCHAR},
      USER_STATUS = #{userStatus,jdbcType=VARCHAR},
      LAST_LOGIN_TIME = #{lastLoginTime,jdbcType=VARCHAR},
      LAST_LOGOUT_TIME = #{lastLogoutTime,jdbcType=VARCHAR},
      LAST_MODI_DATE = #{lastModiDate,jdbcType=VARCHAR},
      UNDERSIGNED = #{undersigned,jdbcType=VARCHAR},
      TERMINAL_IP = #{terminalIp,jdbcType=VARCHAR},
      TERMINAL_MAC = #{terminalMac,jdbcType=VARCHAR},
      LOGIN_PC_SERVER = #{loginPcServer,jdbcType=VARCHAR},
      LOGIN_MOBILE_SERVER = #{loginMobileServer,jdbcType=VARCHAR}
    where USER_NO = #{userNo,jdbcType=VARCHAR}
      and BANK_NO = #{bankNo,jdbcType=VARCHAR}
      and SYSTEM_NO = #{systemNo,jdbcType=VARCHAR}
      and PROJECT_NO = #{projectNo,jdbcType=VARCHAR}
  </update>
  
<!-- //////////////////////////自定义语句//////////////////////////////// -->
  <select id="selectWithoutClobBySelective" parameterType="com.sunyard.ars.system.bean.busm.UserBean" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from SM_USERS_TB
    <where>
      <if test="Bean.userNo != null and Bean.userNo != ''">
        USER_NO = #{Bean.userNo,jdbcType=VARCHAR}
      </if>
      <if test="Bean.organNo != null and Bean.organNo != ''">
        AND ORGAN_NO = #{Bean.organNo,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userName != null and Bean.userName != ''">
        AND USER_NAME = #{Bean.userName,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userEnable != null and Bean.userEnable != ''">
        AND USER_ENABLE = #{Bean.userEnable,jdbcType=CHAR}
      </if>
      <if test="Bean.tellerlvl != null and Bean.tellerlvl != ''">
        AND TELLERLVL = #{Bean.tellerlvl,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginMode != null and Bean.loginMode != ''">
        AND LOGIN_MODE = #{Bean.loginMode,jdbcType=CHAR}
      </if>
      <if test="Bean.loginState != null and Bean.loginState != ''">
        AND LOGIN_STATE = #{Bean.loginState,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userStatus != null and Bean.userStatus != ''">
        AND USER_STATUS = #{Bean.userStatus,jdbcType=VARCHAR}
      </if>
      <if test="Bean.lastLoginTime != null and Bean.lastLoginTime != ''">
        AND LAST_LOGIN_TIME = #{Bean.lastLoginTime,jdbcType=VARCHAR}
      </if>
      <if test="Bean.lastLogoutTime != null and Bean.lastLogoutTime != ''">
        AND LAST_LOGOUT_TIME = #{Bean.lastLogoutTime,jdbcType=VARCHAR}
      </if>
      <if test="Bean.lastModiDate != null and Bean.lastModiDate != ''">
        AND LAST_MODI_DATE = #{Bean.lastModiDate,jdbcType=VARCHAR}
      </if>
      <if test="Bean.undersigned != null and Bean.undersigned != ''">
        AND UNDERSIGNED = #{Bean.undersigned,jdbcType=VARCHAR}
      </if>
      <if test="Bean.terminalIp != null and Bean.terminalIp != ''">
        AND TERMINAL_IP = #{Bean.terminalIp,jdbcType=VARCHAR}
      </if>
      <if test="Bean.terminalMac != null and Bean.terminalMac != ''">
        AND TERMINAL_MAC = #{Bean.terminalMac,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginPcServer != null and Bean.loginPcServer != ''">
        AND LOGIN_PC_SERVER = #{Bean.loginPcServer,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginMobileServer != null and Bean.loginMobileServer != ''">
		AND LOGIN_MOBILE_SERVER = #{Bean.loginMobileServer,jdbcType=VARCHAR}
      </if>
       <if test="RoleNo != null and  RoleNo != ''">
        AND user_no  in  (select user_no from sm_user_role_tb where role_no = #{RoleNo})
      </if>
      <if test="hasPrivOrganFlag != 0">
          AND ORGAN_NO IN (SELECT ORGAN_NO FROM SM_USER_ORGAN_TB WHERE USER_NO=#{Bean.bankNo,jdbcType=VARCHAR})
	  </if>
      <if test="hasPrivOrganFlag == 0">
		AND EXISTS (select 1
		from sm_organ_tb sot, sm_organ_parent_tb sopt
		where
		exists (select 1
		from sm_users_tb sut
		where sut.user_no = #{Bean.bankNo,jdbcType=VARCHAR}
		and sot.organ_no = sut.organ_no)
		and sot.organ_no = sopt.parent_organ
		and sopt.organ_no=ORGAN_NO
		)
	  </if>
    </where>
  </select>
  
  <delete id="deleteByUserNoList">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from SM_USERS_TB
    where
     <if test="userNoList!=null and userNoList.size!=0">
		USER_NO in
		<foreach collection="userNoList" item="userNo" index="index" open="(" close=")" separator="," >
			#{userNo}
		</foreach>
     </if>
     <if test="userNoList==null or userNoList.size==0">
        1=2
     </if>
  </delete>
  <update id="resetPasswordByUserNoList">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update SM_USERS_TB set PASSWORD = #{password} ,user_status='1', error_count = '0'
    where
     <if test="userNoList!=null and userNoList.size!=0">
		USER_NO in
		<foreach collection="userNoList" item="userNo" index="index" open="(" close=")" separator="," >
			#{userNo}
		</foreach>
     </if>
     <if test="userNoList==null or userNoList.size==0">
        1=2
     </if>
  </update>

  <select id="selectUserInfo" parameterType="java.lang.String" resultMap="BaseResultMap">
    select 
    USER_NO, ORGAN_NO, USER_NAME
    from SM_USERS_TB
    where USER_NO = #{userNo,jdbcType=VARCHAR}
  </select>
  

  
  <select id="selectUser" parameterType="java.util.HashMap" resultType="java.util.HashMap">
  		 select 
    	 	USER_NO,
    	 	CONCAT(CONCAT(USER_NO,'--'),USER_NAME)  as content
  		 from sm_users_tb
		 where  1=1
		 <if test="organNo != null and organNo !=''">
				AND  ORGAN_NO = #{organNo} 
		</if>
		 <if test="userNo != null and userNo !=''">
				AND  USER_NO != #{userNo}
		</if>
  </select>
  
  <select id="checkUser" parameterType="java.util.HashMap" resultType="java.lang.Integer">
  	 select count(1) from sm_users_tb where PASSWORD=#{password,jdbcType=VARCHAR} and USER_NO=#{userNo,jdbcType=VARCHAR}
  </select>
  
  <select id="checkGrantUser" parameterType="java.util.HashMap" resultType="java.lang.Integer">
  	 select count(1) from sm_user_role_tb ur
 	   where user_no =#{userNo,jdbcType=VARCHAR} and role_no in
       	(select code from sm_dictionary_tb where field_name = 'GRANT_ROLE')
       and exists (select 1 from sm_users_tb u where ur.user_no = u.user_no and u.organ_no =#{organNo,jdbcType=VARCHAR})
  </select>
  
  <select id="selectUserList" parameterType="java.util.HashMap" resultMap="BaseResultMap">
    select 
    <include refid="Base_Column_List" />
    from SM_USERS_TB T
    <where>
    	<if test="organNoList != null and organNoList.size != 0">
          (
          <foreach collection="organNoList" item="listSon" open="(" separator="OR" close=")">
            ORGAN_NO in
            <foreach collection="listSon" item="organNo" index="index" open="(" close=")" separator=",">
              #{organNo}
            </foreach>
          </foreach>
          )
    	</if>
		<if test="userNoList != null and userNoList.size != 0">
			AND USER_NO in
			<foreach collection="userNoList" item="userNo" index="index" open="(" close=")" separator="," >
				#{userNo}
			</foreach>
    	</if>
        <if test="roleNoList != null and roleNoList.size != 0">
			and user_no in (select distinct (user_no) from SM_USER_ROLE_TB where role_no in
			<foreach collection="roleNoList" item="roleNo" index="index" open="(" close=")" separator="," >
				#{roleNo}
			</foreach>
			)
    	</if>
    	<if test="hasPrivOrganFlag != 0">
		AND ORGAN_NO IN (SELECT ORGAN_NO FROM SM_USER_ORGAN_TB WHERE
		USER_NO=#{userNo,jdbcType=VARCHAR})
		</if>
		<if test="hasPrivOrganFlag == 0">
			AND EXISTS (select 1
			from sm_organ_tb sot, sm_organ_parent_tb sopt
			where
			exists (select 1
			from sm_users_tb sut
			where sut.user_no = #{userNo,jdbcType=VARCHAR}
			and sot.organ_no = sut.organ_no)
			and sot.organ_no = sopt.parent_organ
			and sopt.organ_no=T.ORGAN_NO
			)
		</if>
	    	
    </where>
    order by T.USER_NO
  </select>
  
  
  
  <select id="selectRoleByRoleNo" parameterType="java.util.Map" resultMap="BaseResultMap">
  
  select  <include refid="Base_Column_List" />
   from SM_USERS_TB sut where sut.organ_no = #{organNo,jdbcType=VARCHAR}
  and 
  sut.user_no in (select surt.user_no from SM_USER_ROLE_TB surt where surt.ROLE_NO in 
  
  <foreach collection="parList" item="roleNo" index="index" open="(" separator="," close=")">
            #{roleNo}
     </foreach>
  
  )
 <if test="userNo != null and userNo != ''">
       AND USER_NO = #{userNo,jdbcType=VARCHAR}
      </if>
     
      <if test="userName != null and userName != ''">
        AND USER_NAME = #{userName,jdbcType=VARCHAR}
      </if>
      <if test="userStatus != null and userStatus != ''">
        AND USER_STATUS = #{userStatus,jdbcType=VARCHAR}
      </if>
     
  </select>
  
  
   <select id="selectBySelective" parameterType="map" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from SM_USERS_TB t
    <where>
      <if test="Bean.userNo != null and Bean.userNo != ''">
        USER_NO = #{Bean.userNo,jdbcType=VARCHAR}
      </if>
      <if test="Bean.organNo != null and Bean.organNo != ''">
        AND ORGAN_NO = #{Bean.organNo,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userName != null and Bean.userName != ''">
        AND USER_NAME = #{Bean.userName,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userEnable != null and Bean.userEnable != ''">
        AND USER_ENABLE = #{Bean.userEnable,jdbcType=CHAR}
      </if>
      <if test="Bean.tellerlvl != null and Bean.tellerlvl != ''">
        AND TELLERLVL = #{Bean.tellerlvl,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginMode != null and Bean.loginMode != ''">
        AND LOGIN_MODE = #{Bean.loginMode,jdbcType=CHAR}
      </if>
      <if test="Bean.loginState != null and Bean.loginState != ''">
        AND LOGIN_STATE = #{Bean.loginState,jdbcType=VARCHAR}
      </if>
      <if test="Bean.userStatus != null and Bean.userStatus != ''">
        AND USER_STATUS = #{Bean.userStatus,jdbcType=VARCHAR}
      </if>
        <if test="Bean.singleLogin != null and Bean.singleLogin != ''">
            AND SINGLE_LOGIN = #{Bean.singleLogin,jdbcType=VARCHAR}
        </if>
      <if test="Bean.lastLoginTime != null and Bean.lastLoginTime != ''">
        AND LAST_LOGIN_TIME = #{Bean.lastLoginTime,jdbcType=VARCHAR}
      </if>
      <if test="Bean.lastLogoutTime != null and Bean.lastLogoutTime != ''">
        AND LAST_LOGOUT_TIME = #{Bean.lastLogoutTime,jdbcType=VARCHAR}
      </if>
      <if test="Bean.lastModiDate != null and Bean.lastModiDate != ''">
        AND LAST_MODI_DATE = #{Bean.lastModiDate,jdbcType=VARCHAR}
      </if>
      <if test="Bean.undersigned != null and Bean.undersigned != ''">
        AND UNDERSIGNED = #{Bean.undersigned,jdbcType=VARCHAR}
      </if>
      <if test="Bean.terminalIp != null and Bean.terminalIp != ''">
        AND TERMINAL_IP = #{Bean.terminalIp,jdbcType=VARCHAR}
      </if>
      <if test="Bean.terminalMac != null and Bean.terminalMac != ''">
        AND TERMINAL_MAC = #{Bean.terminalMac,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginPcServer != null and Bean.loginPcServer != ''">
        AND LOGIN_PC_SERVER = #{Bean.loginPcServer,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginMobileServer != null and Bean.loginMobileServer != ''">
        AND LOGIN_MOBILE_SERVER = #{Bean.loginMobileServer,jdbcType=VARCHAR}
      </if>
      <if test="Bean.loginState != null and Bean.loginState != ''">
        AND LOGIN_STATE = #{Bean.loginState,jdbcType=VARCHAR}
      </if>
       <if test="RoleNo != null and  RoleNo != ''">
        AND user_no  in  (select user_no from sm_user_role_tb where role_no = #{RoleNo})
      </if>
      <if test="hasPrivOrganFlag != 0">
		AND ORGAN_NO IN (SELECT ORGAN_NO FROM SM_USER_ORGAN_TB WHERE
		USER_NO=#{Bean.bankNo,jdbcType=VARCHAR})
	 </if>
	 <if test="hasPrivOrganFlag == 0">
		AND EXISTS (select 1
		from sm_organ_tb sot,
		sm_organ_parent_tb sopt
		where
		exists (select 1
		from sm_users_tb sut
		where
		sut.user_no = #{Bean.bankNo,jdbcType=VARCHAR}
		and sot.organ_no =
		sut.organ_no)
		and sot.organ_no = sopt.parent_organ
		and
		sopt.organ_no=t.ORGAN_NO
		)
	 </if>
	    	
    </where>
  </select>
  
  <!--查询可操作某笔审核任务的用户  -->
  <select id="getUsersToApply" parameterType="java.util.HashMap"
	resultType="java.util.HashMap">
	<!-- select user_no || '-' || user_name as "name", user_no as "value" from
	sm_users_tb t
	where
	<if test="hasPrivOrganFlag != 0">
		exists (select 1 from sm_user_organ_tb t1 where t1.user_no = t.user_no and
		t1.organ_no = #{organNo})
	</if>
	<if test="hasPrivOrganFlag == 0">
	  exists (select 1 from sm_organ_parent_tb where organ_no=#{organNo} and parent_organ=t.organ_no)
	</if>
	and exists(select 1 from sm_right_tb t3 join sm_user_role_tb t4 on
	t3.role_no = t4.role_no where t4.user_no=t.user_no and t3.menu_id in
	(select menu_id from sm_menu_tb t5 where t5.menu_class='ma'))
	<if test="hasPrivOrganFlag != 0">
		and exists (select 1 from sm_user_organ_tb t1 where t1.organ_no =
		t.organ_no and t1.user_no = #{userNo})
	</if>
	<if test="hasPrivOrganFlag == 0">
		AND EXISTS (select 1
		from sm_organ_tb sot, sm_organ_parent_tb sopt
		where
		exists (select 1
		from sm_users_tb sut
		where sut.user_no =#{userNo}
		and sot.organ_no = sut.organ_no)
		and sot.organ_no = sopt.parent_organ
		and sopt.organ_no=t.organ_no
		)
	</if>
	<if test="hasUsers != null and  hasUsers != ''">
		and user_no not in
		<foreach collection="hasUsers" item="hasUser" index="index"
			open="(" separator="," close=")">
			#{hasUser}
		</foreach>
	</if> -->
	select user_no || '-' || user_name as "name", user_no as "value" from
  sm_users_tb t
  where
    exists (select 1 from sm_user_organ_tb t1 where t1.user_no = t.user_no and
    t1.organ_no = #{organNo})
  and exists(select 1 from sm_right_tb t3 join sm_user_role_tb t4 on
  t3.role_no = t4.role_no where t4.user_no=t.user_no and t3.menu_id in
  (select menu_id from sm_menu_tb t5 where t5.menu_class='ma'))
  <if test="hasPrivOrganFlag != 0">
    and exists (select 1 from sm_user_organ_tb t1 where t1.organ_no =
    t.organ_no and t1.user_no = #{userNo})
  </if>
  <if test="hasPrivOrganFlag == 0">
    AND EXISTS (select 1
    from sm_organ_tb sot, sm_organ_parent_tb sopt
    where
    exists (select 1
    from sm_users_tb sut
    where sut.user_no =#{userNo}
    and sot.organ_no = sut.organ_no)
    and sot.organ_no = sopt.parent_organ
    and sopt.organ_no=t.organ_no
    )
  </if>
  <if test="hasUsers != null and  hasUsers != ''">
    and user_no not in
    <foreach collection="hasUsers" item="hasUser" index="index"
      open="(" separator="," close=")">
      #{hasUser}
    </foreach>
  </if>
  union all
  select user_no || '-' || user_name as "name", user_no as "value" from
  sm_users_tb t
  where
    exists (select 1 from sm_organ_parent_tb where organ_no=#{organNo} and parent_organ=t.organ_no)
  and exists(select 1 from sm_right_tb t3 join sm_user_role_tb t4 on
  t3.role_no = t4.role_no where t4.user_no=t.user_no and t3.menu_id in
  (select menu_id from sm_menu_tb t5 where t5.menu_class='ma'))
  <if test="hasPrivOrganFlag != 0">
    and exists (select 1 from sm_user_organ_tb t1 where t1.organ_no =
    t.organ_no and t1.user_no = #{userNo})
  </if>
  <if test="hasPrivOrganFlag == 0">
    AND EXISTS (select 1
    from sm_organ_tb sot, sm_organ_parent_tb sopt
    where
    exists (select 1
    from sm_users_tb sut
    where sut.user_no =#{userNo}
    and sot.organ_no = sut.organ_no)
    and sot.organ_no = sopt.parent_organ
    and sopt.organ_no=t.organ_no
    )
  </if>
  <if test="hasUsers != null and  hasUsers != ''">
    and user_no not in
    <foreach collection="hasUsers" item="hasUser" index="index"
      open="(" separator="," close=")">
      #{hasUser}
    </foreach>
  </if>
  and not exists
 (select 1 from SM_USER_organ_TB suot where suot.user_no = t.User_No)
	
</select>
</mapper>