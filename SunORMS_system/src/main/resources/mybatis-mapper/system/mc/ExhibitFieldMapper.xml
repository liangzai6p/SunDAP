<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunyard.ars.system.dao.mc.ExhibitFieldMapper">
  <resultMap id="BaseResultMap" type="com.sunyard.ars.system.pojo.mc.ExhibitField">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="ID" jdbcType="INTEGER" property="id" />
    <result column="ROWNO" jdbcType="INTEGER" property="rowno" />
    <result column="MODEL_ID" jdbcType="INTEGER" property="modelId" />
    <result column="TABLE_FIELD_ID" jdbcType="INTEGER" property="tableFieldId" />
    <result column="FORMAT" jdbcType="CHAR" property="format" />
    <result column="ISFIND" jdbcType="CHAR" property="isfind" />
    <result column="ISDROPDOWN" jdbcType="CHAR" property="isdropdown" />
    <result column="ISIMPORTANT" jdbcType="CHAR" property="isimportant" />
    <result column="RELATE_ID" jdbcType="INTEGER" property="relateId" />
    <result column="OPERATOR" jdbcType="CHAR" property="operator" />
    <result column="FILTER_TYPE" jdbcType="CHAR" property="filterType"/>
    <result column="ISTUOMIN" jdbcType="CHAR" property="isTuoMin"/>
    <result column="ISPICTUREFIELD" jdbcType="CHAR" property="isPictureField"/>
    <result column="EXHIBIT_NAME" jdbcType="VARCHAR" property="exhibitName"/>
    <result column="NAME" jdbcType="VARCHAR" property="enName"/>
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    ID, ROWNO, MODEL_ID, TABLE_FIELD_ID, FORMAT, ISFIND, ISDROPDOWN, ISIMPORTANT, RELATE_ID, 
    OPERATOR,FILTER_TYPE,ISTUOMIN,ISPICTUREFIELD,EXHIBIT_NAME
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from MC_EXHIBIT_FIELD_TB
    where ID = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from MC_EXHIBIT_FIELD_TB
    where ID = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into MC_EXHIBIT_FIELD_TB (ID, ROWNO, MODEL_ID, 
      TABLE_FIELD_ID, FORMAT, ISFIND, 
      ISDROPDOWN, ISIMPORTANT, RELATE_ID, 
      OPERATOR)
    values (#{id,jdbcType=INTEGER}, #{rowno,jdbcType=INTEGER}, #{modelId,jdbcType=INTEGER}, 
      #{tableFieldId,jdbcType=INTEGER}, #{format,jdbcType=CHAR}, #{isfind,jdbcType=CHAR}, 
      #{isdropdown,jdbcType=CHAR}, #{isimportant,jdbcType=CHAR}, #{relateId,jdbcType=INTEGER}, 
      #{operator,jdbcType=CHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into MC_EXHIBIT_FIELD_TB
     <selectKey resultType="INTEGER" order="BEFORE" keyProperty="id">  
      select  case when max(id)+1 is null  then 1 else max(id)+1 end  as id from MC_EXHIBIT_FIELD_TB
  	 </selectKey> 
  	 
    <trim prefix="(" suffix=")" suffixOverrides=",">
      ID,
    <if test="exhibitName != null">
        Exhibit_Name,
      </if>
      <if test="filterType != null">
        FILTER_TYPE,
      </if>
      <if test="isTuoMin != null">
        ISTUOMIN,
      </if>
      <if test="isPictureField != null">
        ISPICTUREFIELD,
      </if>   
      <if test="rowno != null">
        ROWNO,
      </if>
      <if test="modelId != null">
        MODEL_ID,
      </if>
      <if test="tableFieldId != null">
        TABLE_FIELD_ID,
      </if>
      <if test="format != null">
        FORMAT,
      </if>
      <if test="isfind != null">
        ISFIND,
      </if>
      <if test="isdropdown != null">
        ISDROPDOWN,
      </if>
      <if test="isimportant != null">
        ISIMPORTANT,
      </if>
      <if test="relateId != null">
        RELATE_ID,
      </if>
      <if test="operator != null">
        OPERATOR,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
       #{id,jdbcType=INTEGER},
      <if test="exhibitName != null">
        #{exhibitName,jdbcType=VARCHAR},
      </if>
      <if test="filterType != null">
        #{filterType,jdbcType=CHAR},
      </if>
      <if test="isTuoMin != null">
       #{isTuoMin,jdbcType=INTEGER},
      </if>
      <if test="isPictureField != null">
        #{isPictureField,jdbcType=INTEGER},
      </if>    
      <if test="rowno != null">
        #{rowno,jdbcType=INTEGER},
      </if>
      <if test="modelId != null">
        #{modelId,jdbcType=INTEGER},
      </if>
      <if test="tableFieldId != null">
        #{tableFieldId,jdbcType=INTEGER},
      </if>
      <if test="format != null">
        #{format,jdbcType=CHAR},
      </if>
      <if test="isfind != null">
        #{isfind,jdbcType=CHAR},
      </if>
      <if test="isdropdown != null">
        #{isdropdown,jdbcType=CHAR},
      </if>
      <if test="isimportant != null">
        #{isimportant,jdbcType=CHAR},
      </if>
      <if test="relateId != null">
        #{relateId,jdbcType=INTEGER},
      </if>
      <if test="operator != null">
        #{operator,jdbcType=CHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update MC_EXHIBIT_FIELD_TB
    <set>
   	  <if test="exhibitName != null">
        Exhibit_Name = #{exhibitName,jdbcType=VARCHAR},
      </if>
      <if test="filterType != null">
        FILTER_TYPE = #{filterType,jdbcType=CHAR},
      </if>
      <if test="isTuoMin != null">
        ISTUOMIN = #{isTuoMin,jdbcType=INTEGER},
      </if>
      <if test="isPictureField != null">
        ISPICTUREFIELD = #{isPictureField,jdbcType=INTEGER},
      </if>
      <if test="rowno != null">
        ROWNO = #{rowno,jdbcType=INTEGER},
      </if>
      <if test="modelId != null">
        MODEL_ID = #{modelId,jdbcType=INTEGER},
      </if>
      <if test="tableFieldId != null">
        TABLE_FIELD_ID = #{tableFieldId,jdbcType=INTEGER},
      </if>
      <if test="format != null">
        FORMAT = #{format,jdbcType=CHAR},
      </if>
      <if test="isfind != null">
        ISFIND = #{isfind,jdbcType=CHAR},
      </if>
      <if test="isdropdown != null">
        ISDROPDOWN = #{isdropdown,jdbcType=CHAR},
      </if>
      <if test="isimportant != null">
        ISIMPORTANT = #{isimportant,jdbcType=CHAR},
      </if>
      <if test="relateId != null">
        RELATE_ID = #{relateId,jdbcType=INTEGER},
      </if>
      <if test="operator != null">
        OPERATOR = #{operator,jdbcType=CHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update MC_EXHIBIT_FIELD_TB
    set ROWNO = #{rowno,jdbcType=INTEGER},
      MODEL_ID = #{modelId,jdbcType=INTEGER},
      TABLE_FIELD_ID = #{tableFieldId,jdbcType=INTEGER},
      FORMAT = #{format,jdbcType=CHAR},
      ISFIND = #{isfind,jdbcType=CHAR},
      ISDROPDOWN = #{isdropdown,jdbcType=CHAR},
      ISIMPORTANT = #{isimportant,jdbcType=CHAR},
      RELATE_ID = #{relateId,jdbcType=INTEGER},
      OPERATOR = #{operator,jdbcType=CHAR}
    where ID = #{id,jdbcType=INTEGER}
  </update>
 
  <select id="selectBySelective" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField" resultMap="BaseResultMap">
  		SELECT 
  		<include refid="Base_Column_List" />
  		 FROM MC_EXHIBIT_FIELD_TB A
  		 <where>
  		 <if test="modelId !=null and modelId !=''">
  		 AND A.MODEL_ID =#{modelId}
  		 </if>
  		 </where>
  		  ORDER BY A.ROWNO,A.ID
  </select>

<!-- 获取英文名 -->
 <select id="selectEnName" parameterType="com.sunyard.ars.system.pojo.mc.ExhibitField" resultMap="BaseResultMap">
 SELECT C.id,C.NAME NAME,C.field_id TABLE_FIELD_ID ,D.ch_name EXHIBIT_NAME FROM mc_model_tb A,mc_table_tb B,mc_table_field_tb C,mc_field_tb D
  <where>
  		 <if test="modelId !=null and modelId !=''">
  		 AND A.id=#{modelId}
  		 </if>
  		 AND A.table_id = B.id AND C.table_id=A.table_id  AND D.id=C.field_id
  		 </where>
 
 </select>

<!--获取脱敏字段-->
 <select id="showIsTuoMin"  parameterType = "java.lang.Integer"   resultType="java.util.HashMap">
     SELECT A.istuomin,B.name FROM mc_exhibit_field_tb A,mc_field_tb B 
     <where>
     <if test="modelId != null and modelId !=''">
     model_id=#{modelId,jdbcType=INTEGER}
     </if>
      AND A.table_field_id=B.id 
     </where>
  </select>


  <!--获取模型展现字段-->
  <select id="showExhibitField"  parameterType = "java.lang.Integer"   resultType="java.util.HashMap">
      SELECT  a.ID,a.NAME,c.exhibit_name CH_NAME,a.TYPE,c.ROWNO,c.FORMAT,c.ISFIND,c.ISDROPDOWN,c.ISIMPORTANT,c.RELATE_ID,a.TABLE_TYPE,a.HASDIC,a.DICNAME,C.ISTUOMIN
      FROM MC_FIELD_TB a,MC_EXHIBIT_FIELD_TB c WHERE a.ID=c.TABLE_FIELD_ID
      AND a.TABLE_TYPE IN(0,5) AND c.MODEL_ID= #{modelId,jdbcType=INTEGER}
      ORDER  BY c.ROWNO
  </select>

  <!--获取模型展现查询字段-->
  <select id="showExhibitQueryField"  parameterType = "java.lang.Integer"   resultType="java.util.HashMap">
      SELECT  A.ID,A.NAME,A.CH_NAME,A.TYPE,C.ROWNO,C.FORMAT,C.ISFIND,C.ISDROPDOWN,C.ISIMPORTANT,C.RELATE_ID,A.TABLE_TYPE,A.HASDIC,A.DICNAME
      FROM MC_FIELD_TB A,MC_EXHIBIT_FIELD_TB C WHERE A.ID=C.TABLE_FIELD_ID
      AND A.TABLE_TYPE IN(0,5) AND C.MODEL_ID= #{modelId,jdbcType=INTEGER} AND C.ISFIND = 1
      AND A.NAME != 'PROC_DATE'
      ORDER  BY C.ROWNO
  </select>

  <update id="updateExhibitChName" parameterType = "java.lang.Integer">
    update mc_exhibit_field_tb ef
   		set ef.exhibit_name =
       		(select ch_name from mc_field_tb f where f.id = ef.table_field_id)
 	where ef.exhibit_name is null and ef.model_id = #{modelId,jdbcType=INTEGER}
  </update>
</mapper>