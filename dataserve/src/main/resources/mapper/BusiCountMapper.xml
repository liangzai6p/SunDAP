<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sunyard.dap.dataserve.mapper.BusiCountMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.sunyard.dap.dataserve.entity.BusiCountDO">
        <result column="BLOC_NO" property="blocNo" />
        <result column="BLOC_NAME" property="blocName" />
        <result column="ZONE_NO" property="zoneNo" />
        <result column="ZONE_NAME" property="zoneName" />
        <result column="BRANCH_NO" property="branchNo" />
        <result column="BRANCH_NAME" property="branchName" />
        <result column="SITE_NO" property="siteNo" />
        <result column="SITE_NAME" property="siteName" />
        <result column="CHANNEL_NO" property="channelNo" />
        <result column="CHANNEL_NAME" property="channelName" />
        <result column="BUSI_COUNT" property="busiCount" />
        <result column="AMOUNT" property="amount" />
        <result column="CUS_COUNT" property="cusCount" />
        <result column="RECORD_TIME" property="recordTime" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        BLOC_NO, BLOC_NAME, ZONE_NO, ZONE_NAME, BRANCH_NO, BRANCH_NAME, SITE_NO, SITE_NAME, CHANNEL_NO, CHANNEL_NAME, BUSI_COUNT, AMOUNT, CUS_COUNT, TO_CHAR(RECORD_TIME,'yyyymmdd') RECORD_TIME
    </sql>

    <select id="listByTime" resultType="java.util.HashMap">
        select
        <include refid="Base_Column_List"/>
        from DM_BUSI_COUNT_TB
        <trim prefix="where" prefixOverrides="and">
            <if test="params.START_TIME != null and params.END_TIME != null">
                to_date(to_char(record_time,'yyyymmdd'),'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>

    <select id="listBranch" resultType="java.util.HashMap">
        select * from DM_BUSI_BRANCH_COUNT_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.BRANCH_NO != null">
                BRANCH_NO = #{params.BRANCH_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(RECORD_TIME,'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>

    <select id="listSite" resultType="java.util.HashMap">
        select * from DM_BUSI_SITE_COUNT_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.SITE_NO != null">
                SITE_NO = #{params.SITE_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(RECORD_TIME,'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>

    <select id="listZone" resultType="java.util.HashMap">
        select * from DM_BUSI_ZONE_COUNT_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.ZONE_NO != null">
                ZONE_NO = #{params.ZONE_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(RECORD_TIME,'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>

    <select id="listChannel" resultType="java.util.HashMap">
        select * from DM_BUSI_CHANNEL_COUNT_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.CHANNEL_NO != null">
                CHANNEL_NO = #{params.CHANNEL_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(RECORD_TIME,'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>

    <select id="listMonthly" resultType="java.util.HashMap">
        select * from DM_BUSI_COUNT_MONTHLY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.START_TIME != null and params.END_TIME != null">
                to_date(MONTH,'yyyymm') between to_date(#{params.START_TIME},'yyyymm') and to_date(#{params.END_TIME},'yyyymm')
            </if>
        </trim>
    </select>

    <select id="listBranchMonthly" parameterType="map" resultType="java.util.HashMap">
        select * from DM_BUSI_BRANCH_MONTHLY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.BRANCH_NO != null">
                BRANCH_NO = #{params.BRANCH_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(MONTH,'yyyymm') between to_date(#{params.START_TIME},'yyyymm') and to_date(#{params.END_TIME},'yyyymm')
            </if>
        </trim>
    </select>

    <select id="listSiteMonthly" resultType="java.util.HashMap">
        select * from DM_BUSI_SITE_MONTHLY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.SITE_NO != null">
                SITE_NO = #{params.SITE_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(MONTH,'yyyymm') between to_date(#{params.START_TIME},'yyyymm') and to_date(#{params.END_TIME},'yyyymm')
            </if>
        </trim>
    </select>
    <select id="listZoneMonthly" resultType="java.util.HashMap">
        select * from DM_BUSI_ZONE_MONTHLY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.ZONE_NO != null">
                ZONE_NO = #{params.ZONE_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(MONTH,'yyyymm') between to_date(#{params.START_TIME},'yyyymm') and to_date(#{params.END_TIME},'yyyymm')
            </if>
        </trim>
    </select>
    <select id="listChannelMonthly" resultType="java.util.HashMap">
        select * from DM_BUSI_CHANNEL_MONTHLY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.CHANNEL_NO != null">
                CHANNEL_NO = #{params.CHANNEL_NO}
            </if>
            <if test="params.START_TIME != null and params.END_TIME != null">
                and to_date(MONTH,'yyyymm') between to_date(#{params.START_TIME},'yyyymm') and to_date(#{params.END_TIME},'yyyymm')
            </if>
        </trim>
    </select>
    <select id="listTotalMinRT" resultType="java.util.HashMap">
        select *
        from DM_BUSI_T_MIN_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.START_TIME != null and params.END_TIME != null">
                to_date(record_time,'yyyymmddhh24mi') between to_date(#{params.START_TIME},'yyyymmddhh24mi') and to_date(#{params.END_TIME},'yyyymmddhh24mi')
            </if>
        </trim>
    </select>
    <select id="listTotalHourRT" resultType="java.util.HashMap">
        select *
        from DM_BUSI_T_HOUR_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.START_TIME != null and params.END_TIME != null">
                to_date(record_time,'yyyymmddhh24') between to_date(#{params.START_TIME},'yyyymmddhh24') and to_date(#{params.END_TIME},'yyyymmddhh24')
            </if>
        </trim>
    </select>
    <select id="listTotalDayRT" resultType="java.util.HashMap">
        select * from DM_BUSI_T_DAY_V
        <trim prefix="where" prefixOverrides="and">
            <if test="params.START_TIME != null and params.END_TIME != null">
                to_date(record_time,'yyyymmdd') between to_date(#{params.START_TIME},'yyyymmdd') and to_date(#{params.END_TIME},'yyyymmdd')
            </if>
        </trim>
    </select>


</mapper>
